% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/MEPmod.R
\name{MEPmod}
\alias{MEPmod}
\title{Predict Conserved MicroExons in a Plant Genome}
\usage{
MEPmod(
  genome,
  min.score = "80\%",
  clusters = NULL,
  high_complexity = TRUE,
  low_copy = FALSE,
  include.intronLoss = TRUE,
  span = 20000,
  min.intron = 20,
  max.intron = 10000,
  cores = 5,
  quietly = FALSE
)
}
\arguments{
\item{genome}{Path(s) to FASTA file(s) or a \code{DNAStringSet} object 
containing genomic sequences.}

\item{min.score}{Minimum match score threshold for exon blocks 
(as percentage string, e.g., \code{"80\%"}).
Passed to \code{\link[Biostrings]{matchPWM}}.}

\item{clusters}{Integer vector specifying which microexon-tag clusters to search 
(default: \code{NULL} searches all clusters).}

\item{high_complexity}{Logical. If \code{TRUE} (default), only searches 
clusters with sequence complexity â‰¥ 0.7 for both 
flanking regions.}

\item{low_copy}{Logical. If \code{TRUE}, restricts search to low-copy clusters 
(1-3 copies in >80\% of 184 land plants).}

\item{include.intronLoss}{Logical. If \code{TRUE}, includes microexons with 
any flanking intron loss.}

\item{span}{Maximum genomic span for microexon-tag detection (default: 20,000 bp).}

\item{min.intron}{Minimum allowed intron size (bp).}

\item{max.intron}{Maximum allowed intron size (bp).}

\item{cores}{Number of CPU cores to use (passed to \code{\link[parallel]{mclapply}}).}

\item{quietly}{Logical. If \code{TRUE}, suppresses all progress messages. 
Default: \code{FALSE} (show detailed progress messages).}
}
\value{
A \code{GRanges} object with 8 metadata columns:
\describe{
  \item{NT}{DNA sequence of the microexon-tag}
  \item{AA}{Peptide sequence encoded by the microexon-tag}
  \item{region}{Genomic span of the microexon-tag}
  \item{block.starts}{Genomic coordinates of exon/intron boundaries}
  \item{block.sizes}{Lengths of exons and introns}
  \item{score}{Match confidence score (higher = more confident)}
  \item{isMicroExon}{\code{TRUE} if no flanking intron loss, \code{FALSE} otherwise}
  \item{cluster}{Cluster ID of the detected microexon-tag}
}
}
\description{
Identifies microexon-tags in plant genomic sequences using gapped 
Position Weight Matrices (PWMs). Scans both DNA strands to detect conserved 
microexon clusters based on sequence patterns.
}
\examples{
suppressPackageStartupMessages(library(BSgenome))
if (!requireNamespace("BSgenome.Athaliana.TAIR.TAIR9", quietly = TRUE))
    BiocManager::install("BSgenome.Athaliana.TAIR.TAIR9")
library(BSgenome.Athaliana.TAIR.TAIR9)

data <- DNAStringSet(BSgenome.Athaliana.TAIR.TAIR9$Chr1[1:1e6])
names(data) <- "Chr1"

res <- MEPmod(genome=data, cores=1, clusters=c(1:50))

res
# GRanges object with 2 ranges and 8 metadata columns:
#        seqnames       ranges strand |                      NT
#          <Rle>     <IRanges>  <Rle> |          <DNAStringSet>
#   [1]     Chr1 456757-456761      + | TTTGATGCTA...ACTGTCTGAC
#   [2]     Chr1 601547-601560      - | AAAGTTGAAT...ACATTCAGAT
#                            AA        region             block.starts   block.sizes
#                 <AAStringSet>     <IRanges>            <IntegerList> <IntegerList>
#   [1] FDARTAWSQC...AFGAVESLSD 456595-456893 456595,456647,456757,...  52,110,5,...
#   [2] KVEFKDNEWK...RLDCLLKHSD 601327-601700 601653,601561,601547,...  48,92,14,...
#            score isMicroExon   cluster
#        <numeric>   <logical> <integer>
#   [1]    0.9817        TRUE         8
#   [2]    0.9242        TRUE        37
#   -------
#   seqinfo: 1 sequence from an unspecified genome; no seqlengths

}
